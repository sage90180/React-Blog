(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{33:function(n,t,e){"use strict";e.r(t);var r=e(1),o=e(0),c=e.n(o),i=e(18),a=e.n(i),u=e(4),s=e(2),p=e(3),d=Object(o.createContext)(null),x="token",b=function(n){localStorage.setItem(x,n)},l=function(){return localStorage.getItem(x)},j=function(n,t){return t(!1),n(null)},f=e(6),h=e(5);function O(){var n=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  padding: 5px 10px;\n  margin: 10px 5px;\n  cursor: pointer;\n  border: solid 1px black;\n  transition: 0.3s;\n  color: white;\n  text-directiom: none;\n  white-space: nowrap;\n  &:hover {\n    border: solid 1px white;\n  }\n  ","\n"]);return O=function(){return n},n}function g(){var n=Object(s.a)(["\n  display: flex;\n  margin-left: auto;\n"]);return g=function(){return n},n}function v(){var n=Object(s.a)(['\n  font-size: 30px;\n  font-weight: 900;\n  margin: 10px 10px 10px 0px;\n  color: #ff7601;\n  font-family: "Permanent Marker", cursive;\n']);return v=function(){return n},n}function m(){var n=Object(s.a)(["\n  display: flex;\n"]);return m=function(){return n},n}function w(){var n=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 10px;\n  background: black;\n  color: white;\n  max-width: 1200px;\n  margin: auto;\n  flex-wrap: wrap;\n"]);return w=function(){return n},n}function y(){var n=Object(s.a)(["\n  background: black;\n"]);return y=function(){return n},n}var k=p.b.div(y()),S=p.b.div(w()),z=p.b.div(m()),C=p.b.div(v()),L=p.b.div(g()),q=Object(p.b)(f.b)(O(),(function(n){return n.$active&&"\n    border: solid 1px white;\n  "}));function F(){var n=Object(h.g)().pathname,t=Object(h.f)(),e=Object(o.useContext)(d),c=e.user,i=e.setUser,a=e.isLoading;return Object(r.jsx)(k,{children:Object(r.jsxs)(S,{children:[Object(r.jsxs)(z,{children:[Object(r.jsx)(C,{children:"HiHi React"}),Object(r.jsxs)(L,{children:[Object(r.jsx)(q,{to:"/",$active:"/"===n,children:"\u9996\u9801"}),Object(r.jsx)(q,{to:"/about",$active:"/about"===n,children:"\u6709\u95dc\u65bc\u6211"}),c&&Object(r.jsx)(q,{to:"/new-post",$active:"/new-post"===n,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),a?null:Object(r.jsxs)(L,{children:[!c&&Object(r.jsx)(q,{to:"/sign-up",$active:"/sign-up"===n,children:"\u8a3b\u518a"}),!c&&Object(r.jsx)(q,{to:"/login",$active:"/login"===n,children:"\u767b\u5165"}),c&&Object(r.jsxs)(q,{children:["\u4f60\u597d\uff01",c.nickname]}),c&&Object(r.jsx)(q,{onClick:function(){b(""),i(null),"/"!==n.pathname&&t.push("/")},children:"\u767b\u51fa"})]})]})})}var I=e(9),$=e.n(I),D="https://student-json-api.lidemy.me",J=function(){var n=l();return fetch("".concat(D,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()}))};function P(){var n=Object(s.a)(["\n  border: solid 2px #888;\n  background: white;\n  padding: 10px;\n  font-size: 25px;\n  font-weight: 900;\n  padding: 7px 15px;\n  box-shadow: 5px 5px 0px #ccc;\n  color: #888;\n  display: block;\n  &:hover {\n    transform: translateY(-5px);\n    box-shadow: 0px 5px 0px #888;\n  }\n  &:first-child {\n    border-radius: 10px 0px 0px 10px;\n  }\n  &:last-child {\n    border-radius: 0px 10px 10px 0px;\n  }\n"]);return P=function(){return n},n}function X(){var n=Object(s.a)(["\n  display: flex;\n  margin-top: 40px;\n  justify-content: center;\n"]);return X=function(){return n},n}function B(){var n=Object(s.a)(["\n  color: #f95757;\n  font-size: 25px;\n  text-align: center;\n  font-weight: 900;\n  line-height: 30px;\n"]);return B=function(){return n},n}function E(){var n=Object(s.a)(["\n  color: #444;\n  font-weight: 900;\n"]);return E=function(){return n},n}function U(){var n=Object(s.a)(["\n  font-size: 20px;\n  color: #444;\n  font-weight: 900;\n  text-directiom: none;\n"]);return U=function(){return n},n}function _(){var n=Object(s.a)(["\n  max-width: 1200px;\n  margin: 0px auto;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 10px 15px;\n  border: solid 2px #888;\n  border-radius: 50px;\n  margin-bottom: 15px;\n  box-shadow: 5px 5px 0px #ccc;\n  &:hover {\n    transform: translateX(-15px);\n    box-shadow: 5px 5px 0px #888;\n  }\n"]);return _=function(){return n},n}function A(){var n=Object(s.a)(["\n  padding: 20px 10px;\n"]);return A=function(){return n},n}var M=p.b.div(A()),N=Object(p.b)(f.b)(_()),T=p.b.div(U()),H=p.b.div(E()),R=p.b.div(B()),Y=p.b.div(X()),G=Object(p.b)(f.b)(P());function K(n){var t=n.post;return Object(r.jsxs)(N,{to:"/posts/".concat(t.id),children:[Object(r.jsx)(T,{children:t.title}),Object(r.jsx)(H,{children:new Date(t.createdAt).toLocaleString()})]})}function Q(){var n=Object(o.useState)([]),t=Object(u.a)(n,2),e=t[0],c=t[1],i=Object(o.useState)(null),a=Object(u.a)(i,2),s=a[0],p=a[1],d=Object(o.useState)(1),x=Object(u.a)(d,2),b=x[0],l=x[1],j=Object(o.useState)(null),f=Object(u.a)(j,2),h=f[0],O=f[1],g=Array.from({length:h},(function(n,t){return t+1}));return Object(o.useEffect)((function(){(function(n){return fetch("".concat(D,"/posts?_page=").concat(n,"&_limit=5&_sort=id&_order=desc")).then((function(n){return n.json()}))})(b).then((function(n){return c(n)})).catch((function(n){console.log(n),p(n)})),fetch("".concat(D,"/posts")).then((function(n){return n.json()})).then((function(n){return Math.ceil(n.length/5)})).then((function(n){return O(n)}))}),[b]),Object(r.jsxs)(M,{children:[s&&Object(r.jsxs)(R,{children:["\u8f09\u5165\u5931\u6557...",Object(r.jsx)("br",{}),s.toString()]}),e.map((function(n){return Object(r.jsx)(K,{post:n},n.id)})),Object(r.jsx)(Y,{children:g.map((function(n){return Object(r.jsx)(G,{onClick:function(){return l(n)},children:n},n)}))})]})}function V(){var n=Object(s.a)(["\n  border: solid 2px #888;\n  border-radius: 30px;\n  padding: 5px 10px;\n  box-shadow: 5px 5px 0px #ccc;\n  width: 100px;\n  text-align: center;\n  margin: 20px auto;\n  cursor: pointer;\n  font-size: 18px;\n  &:hover {\n    transform: translateX(10px);\n    box-shadow: 5px 5px 0px #888;\n  }\n"]);return V=function(){return n},n}function W(){var n=Object(s.a)(["\n  font-size: 20px;\n  font-weight: 900;\n  color: #333;\n  margin-bottom: 15px;\n  input {\n    margin-left: 10px;\n    border-radius: 20px;\n    padding: 5px 10px;\n    font-size: 20px;\n    border: solid 2px #888;\n    box-shadow: 5px 5px 0px #ccc;\n    background: white;\n  }\n"]);return W=function(){return n},n}function Z(){var n=Object(s.a)(["\n  text-align: center;\n  margin-top: 50px;\n"]);return Z=function(){return n},n}function nn(){var n=Object(s.a)(["\n  color: red;\n"]);return nn=function(){return n},n}K.prototype={post:$.a.object};var tn=p.b.div(nn()),en=p.b.form(Z()),rn=p.b.div(W()),on=p.b.button(V());function cn(){var n=Object(o.useContext)(d),t=n.setUser,e=n.isLoading,c=n.setIsLoading,i=Object(o.useState)(""),a=Object(u.a)(i,2),s=a[0],p=a[1],x=Object(o.useState)(""),l=Object(u.a)(x,2),f=l[0],O=l[1],g=Object(o.useState)(),v=Object(u.a)(g,2),m=v[0],w=v[1],y=Object(h.f)();return Object(r.jsxs)(en,{onSubmit:function(n){n.preventDefault(),e||(c(!0),w(null),function(n,t){return fetch("".concat(D,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(s,f).then((function(n){if(0===n.ok)return w(n.message);b(n.token),J().then((function(n){if(1!==n.ok)return b(null),w(n.toString());c(!1),t(n.data),y.push("/")}))})).catch((function(n){c(!1),w(n.message)})))},children:[Object(r.jsxs)(rn,{children:["\u5e33 \u865f",Object(r.jsx)("input",{value:s,onChange:function(n){return p(n.target.value)},onFocus:function(){return j(w,c)},type:"text"})]}),Object(r.jsxs)(rn,{children:["\u5bc6 \u78bc",Object(r.jsx)("input",{value:f,onChange:function(n){return O(n.target.value)},onFocus:function(){return j(w,c)},type:"password"})]}),m&&Object(r.jsxs)(tn,{children:["\u932f\u8aa4\uff1a",m]}),Object(r.jsx)(on,{children:"\u767b \u5165"})]})}function an(){var n=Object(s.a)(["\n  color: red;\n  margin-bottom: 20px;\n  text-align: center;\n"]);return an=function(){return n},n}function un(){var n=Object(s.a)(["\n  border: solid 2px #888;\n  border-radius: 30px;\n  padding: 8px 10px;\n  box-shadow: 5px 5px 0px #ccc;\n  width: 100px;\n  text-align: center;\n  margin: 20px auto;\n  cursor: pointer;\n  font-size: 18px;\n  &:hover {\n    transform: translateX(10px);\n    box-shadow: 5px 5px 0px #888;\n  }\n"]);return un=function(){return n},n}function sn(){var n=Object(s.a)(["\n  display: flex;\n  font-size: 25px;\n  margin-top: 30px;\n  width: 100%;\n  white-space: nowrap;\n  align-items: start;\n  textarea {\n    width: 100%;\n    border: solid 2px #888;\n    border-radius: 10px;\n    box-shadow: 7px 7px 0px #ccc;\n    padding: 10px;\n    font-size: 20px;\n  }\n"]);return sn=function(){return n},n}function pn(){var n=Object(s.a)(["\n  display: flex;\n  font-size: 25px;\n  width: 100%;\n  white-space: nowrap;\n  align-items: center;\n  input {\n    width: 100%;\n    height: 40px;\n    border: solid 2px #888;\n    border-radius: 10px;\n    box-shadow: 7px 7px 0px #ccc;\n    padding: 10px;\n    font-size: 20px;\n  }\n"]);return pn=function(){return n},n}function dn(){var n=Object(s.a)(["\n  max-width: 1200px;\n  margin: auto;\n  margin-top: 20px;\n  padding: 10px 30px 30px 30px;\n  display: flex;\n  flex-direction: column;\n"]);return dn=function(){return n},n}var xn=p.b.form(dn()),bn=p.b.div(pn()),ln=p.b.div(sn()),jn=p.b.button(un()),fn=p.b.div(an());function hn(){var n=Object(o.useContext)(d).user,t=Object(o.useState)(""),e=Object(u.a)(t,2),c=e[0],i=e[1],a=Object(o.useState)(""),s=Object(u.a)(a,2),p=s[0],x=s[1],b=Object(o.useState)(),j=Object(u.a)(b,2),f=j[0],O=j[1],g=Object(h.f)();return Object(r.jsxs)(xn,{onSubmit:function(t){if(t.preventDefault(),!n)return O("\u8acb\u5148\u767b\u5165");(function(n,t){var e=l();return fetch("".concat(D,"/posts"),{method:"POST",headers:{"content-type":"application/json",authorization:"Bearer ".concat(e)},body:JSON.stringify({title:n,body:t})}).then((function(n){return n.json()}))})(c,p).then((function(n){g.push("/")}))},children:[f&&Object(r.jsxs)(fn,{children:["\u932f\u8aa4\uff1a",f]}),Object(r.jsxs)(bn,{children:["\u6a19 \u984c\uff1a",Object(r.jsx)("input",{type:"text",value:c,onChange:function(n){return i(n.target.value)}})]}),Object(r.jsxs)(ln,{children:["\u5167 \u5bb9\uff1a",Object(r.jsx)("textarea",{rows:"10",type:"text",value:p,onChange:function(n){return x(n.target.value)}})]}),Object(r.jsx)(jn,{children:"\u9001 \u51fa"})]})}function On(){var n=Object(s.a)(["\n  border: solid 2px #888;\n  border-radius: 20px;\n  padding: 8px 10px;\n  box-shadow: 5px 5px 0px #ccc;\n  max-width: 100px;\n  text-align: center;\n  margin-top: 20px;\n  cursor: pointer;\n  &:hover {\n    transform: translateX(-10px);\n    box-shadow: 5px 5px 0px #888;\n  }\n"]);return On=function(){return n},n}function gn(){var n=Object(s.a)(["\n  padding: 15px 0px;\n  border-bottom: solid 1px #ddd;\n  line-height: 26px;\n  color: #333;\n"]);return gn=function(){return n},n}function vn(){var n=Object(s.a)(["\n  color: #888;\n  font-weight: bold;\n  padding: 10px 0px;\n  border-bottom: solid 1px #ddd;\n"]);return vn=function(){return n},n}function mn(){var n=Object(s.a)(["\n  font-weight: 900;\n  font-size: 30px;\n  margin-bottom: 15px;\n"]);return mn=function(){return n},n}function wn(){var n=Object(s.a)(["\n  max-width: 1200px;\n  margin: auto;\n  border: solid 2px #888;\n  border-radius: 20px;\n  margin-top: 20px;\n  box-shadow: 10px 10px 0px #ccc;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n"]);return wn=function(){return n},n}var yn=p.b.div(wn()),kn=p.b.div(mn()),Sn=p.b.div(vn()),zn=p.b.div(gn()),Cn=Object(p.b)(f.b)(On()),Ln=function(n){var t=n.post,e=n.history;return t?Object(r.jsxs)(yn,{children:[Object(r.jsx)(kn,{children:t.title}),Object(r.jsx)(Sn,{children:new Date(t.createdAt).toLocaleString()}),Object(r.jsx)(zn,{children:t.body}),Object(r.jsx)(Cn,{onClick:function(){return e.goBack()},children:"\u4e0a\u4e00\u9801"})]}):null};function qn(){var n=Object(h.f)(),t=Object(h.h)().id,e=Object(o.useState)(""),c=Object(u.a)(e,2),i=c[0],a=c[1];return Object(o.useEffect)((function(){(function(n){return fetch("".concat(D,"/posts?id=").concat(n)).then((function(n){return n.json()}))})(t).then((function(n){return a(n[0])}))}),[t]),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(Ln,{post:i,history:n})})}function Fn(){var n=Object(s.a)(["\n  width: 200px;\n  height: 300px;\n  border: solid 2px #888;\n  margin-right: 20px;\n"]);return Fn=function(){return n},n}function In(){var n=Object(s.a)(["\n  max-width: 1200px;\n  margin: auto;\n  border: solid 2px #888;\n  border-radius: 20px;\n  margin-top: 20px;\n  box-shadow: 10px 10px 0px #ccc;\n  padding: 20px;\n  display: flex;\n  font-size: 40px;\n  color: #555;\n"]);return In=function(){return n},n}var $n=p.b.div(In()),Dn=p.b.div(Fn());function Jn(){return Object(r.jsxs)($n,{children:[Object(r.jsx)(Dn,{}),"\u4fee\u5efa\u4e2d..."]})}function Pn(){var n=Object(s.a)(["\n  border: solid 2px #888;\n  border-radius: 30px;\n  padding: 5px 10px;\n  box-shadow: 5px 5px 0px #ccc;\n  width: 100px;\n  text-align: center;\n  margin: 20px auto;\n  cursor: pointer;\n  font-size: 18px;\n  &:hover {\n    transform: translateX(10px);\n    box-shadow: 5px 5px 0px #888;\n  }\n"]);return Pn=function(){return n},n}function Xn(){var n=Object(s.a)(["\n  font-size: 20px;\n  font-weight: 900;\n  color: #333;\n  margin-bottom: 15px;\n  input {\n    margin-left: 10px;\n    border-radius: 20px;\n    padding: 5px 10px;\n    font-size: 20px;\n    border: solid 2px #888;\n    box-shadow: 5px 5px 0px #ccc;\n    background: white;\n  }\n"]);return Xn=function(){return n},n}function Bn(){var n=Object(s.a)(["\n  text-align: center;\n  margin-top: 50px;\n"]);return Bn=function(){return n},n}function En(){var n=Object(s.a)(["\n  color: red;\n"]);return En=function(){return n},n}var Un=p.b.div(En()),_n=p.b.form(Bn()),An=p.b.div(Xn()),Mn=p.b.button(Pn());function Nn(){var n=Object(o.useContext)(d),t=n.setUser,e=n.isLoading,c=n.setIsLoading,i=Object(o.useState)(""),a=Object(u.a)(i,2),s=a[0],p=a[1],x=Object(o.useState)(""),l=Object(u.a)(x,2),f=l[0],O=l[1],g=Object(o.useState)(""),v=Object(u.a)(g,2),m=v[0],w=v[1],y=Object(o.useState)(),k=Object(u.a)(y,2),S=k[0],z=k[1],C=Object(h.f)();return Object(r.jsxs)(_n,{onSubmit:function(n){n.preventDefault(),e||(c(!0),function(n,t,e){return fetch("".concat(D,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:n,username:t,password:e})}).then((function(n){return n.json()}))}(s,f,m).then((function(n){if(0===n.ok)return z(n.message);b(n.token),J().then((function(n){if(1!==n.ok)return b(null),c(!1),z(n.toString());t(n.data),C.push("/")}))})).catch((function(n){c(!1),z(n.message)})))},children:[Object(r.jsxs)(An,{children:["\u66b1 \u7a31",Object(r.jsx)("input",{value:s,onChange:function(n){return p(n.target.value)},onFocus:function(){return j(z,c)},type:"text"})]}),Object(r.jsxs)(An,{children:["\u5e33 \u865f",Object(r.jsx)("input",{value:f,onChange:function(n){return O(n.target.value)},onFocus:function(){return j(z,c)},type:"text"})]}),Object(r.jsxs)(An,{children:["\u5bc6 \u78bc",Object(r.jsx)("input",{value:m,onChange:function(n){return w(n.target.value)},onFocus:function(){return j(z,c)},type:"password"})]}),S&&Object(r.jsxs)(Un,{children:["\u932f\u8aa4\uff1a",S]}),Object(r.jsx)(Mn,{children:"\u8a3b \u518a"})]})}function Tn(){var n=Object(s.a)(["\n  font-size: 60px;\n  font-weight: 900;\n  position: fixed;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return Tn=function(){return n},n}var Hn=p.b.div(Tn());var Rn=function(){var n=Object(o.useState)(null),t=Object(u.a)(n,2),e=t[0],c=t[1],i=Object(o.useState)(!0),a=Object(u.a)(i,2),s=a[0],p=a[1];return Object(o.useEffect)((function(){J().then((function(n){p(!0),n.ok&&(c(n.data),p(!1)),p(!1)}))}),[]),Object(r.jsxs)(d.Provider,{value:{user:e,setUser:c,isLoading:s,setIsLoading:p},children:[s&&Object(r.jsx)(Hn,{children:"Loading..."}),Object(r.jsxs)(f.a,{children:[Object(r.jsx)(F,{}),Object(r.jsxs)(h.c,{children:[Object(r.jsx)(h.a,{exact:!0,path:"/",children:Object(r.jsx)(Q,{})}),Object(r.jsx)(h.a,{path:"/login",children:Object(r.jsx)(cn,{})}),Object(r.jsx)(h.a,{path:"/new-post",children:Object(r.jsx)(hn,{})}),Object(r.jsx)(h.a,{path:"/about",children:Object(r.jsx)(Jn,{})}),Object(r.jsx)(h.a,{path:"/posts/:id",children:Object(r.jsx)(qn,{})}),Object(r.jsx)(h.a,{path:"/sign-up",children:Object(r.jsx)(Nn,{})})]})]})]})};function Yn(){var n=Object(s.a)(["\nhtml {\n  background: white;\n  * {\n    // border: solid 1px black;\n    transition: .3s\n  }\n}\n"]);return Yn=function(){return n},n}function Gn(){var n=Object(s.a)(["\nhtml, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {\n  margin: 0;\n  padding: 0;\n  border: 0;\n  font-size: 100%;\n  font: inherit;\n  vertical-align: baseline;\n  box-sizing: border-box;\n}\naddress, caption, cite, code, dfn, em, strong, th, var, b {\n  font-weight: normal;\n  font-style: normal;\n}\nabbr, acronym {\n  border: 0;\n}\narticle, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section {\n  display: block;\n}\n*,\n*::after,\n*::before {\n  margin: 0;\n  padding: 0;\n  box-sizing: inherit;\n}\nhtml {\n  text-size-adjust: 100%;\n  box-sizing: border-box;\n}\nbody {\n    line-height: 1;\n}\nol, ul {\n  list-style: none;\n}\nblockquote, q {\n  quotes: none;\n}\nblockquote {\n  &:before,   &:after {\n    content: '';\n    content: none;\n  }\n}\nq {\n  &:before,   &:after {\n    content: '';\n    content: none;\n  }\n}\ntable {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\ncaption, th {\n  text-align: left;\n}\ntextarea {\n  resize: none;\n}\na {\n  text-decoration: none;\n  cursor: pointer;\n}\nbutton {\n  padding: 0;\n  border: none;\n  background: none;\n}\n"]);return Gn=function(){return n},n}var Kn=Object(p.a)(Gn()),Qn=Object(p.a)(Yn());a.a.render(Object(r.jsxs)(c.a.StrictMode,{children:[Object(r.jsx)(Kn,{}),Object(r.jsx)(Qn,{}),Object(r.jsx)(Rn,{})]}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.ea6e7493.chunk.js.map